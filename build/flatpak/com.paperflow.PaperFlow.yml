app-id: com.paperflow.PaperFlow
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
base: org.electronjs.Electron2.BaseApp
base-version: '23.08'
command: paperflow
separate-locales: false

finish-args:
  # X11 and Wayland support
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --socket=fallback-x11

  # GPU acceleration
  - --device=dri

  # Audio (for notification sounds)
  - --socket=pulseaudio

  # Network access (for updates)
  - --share=network

  # File access
  - --filesystem=home
  - --filesystem=xdg-documents
  - --filesystem=xdg-download
  - --filesystem=/run/media
  - --filesystem=/media

  # Printing
  - --socket=cups

  # Notifications
  - --talk-name=org.freedesktop.Notifications

  # System tray
  - --talk-name=org.kde.StatusNotifierWatcher
  - --talk-name=com.canonical.AppMenu.Registrar
  - --talk-name=com.canonical.Unity

  # Secrets/keyring
  - --talk-name=org.freedesktop.secrets
  - --talk-name=org.gnome.keyring

  # Session management
  - --talk-name=org.gnome.SessionManager

  # Accessibility
  - --talk-name=org.a11y.Bus

  # Portal access
  - --talk-name=org.freedesktop.portal.Desktop

  # Environment
  - --env=ELECTRON_OZONE_PLATFORM_HINT=auto

modules:
  - name: paperflow
    buildsystem: simple
    build-commands:
      - install -D paperflow /app/bin/paperflow
      - install -Dm644 paperflow.desktop /app/share/applications/com.paperflow.PaperFlow.desktop
      - install -Dm644 paperflow.metainfo.xml /app/share/metainfo/com.paperflow.PaperFlow.metainfo.xml
      - install -Dm644 icons/16x16.png /app/share/icons/hicolor/16x16/apps/com.paperflow.PaperFlow.png
      - install -Dm644 icons/32x32.png /app/share/icons/hicolor/32x32/apps/com.paperflow.PaperFlow.png
      - install -Dm644 icons/48x48.png /app/share/icons/hicolor/48x48/apps/com.paperflow.PaperFlow.png
      - install -Dm644 icons/64x64.png /app/share/icons/hicolor/64x64/apps/com.paperflow.PaperFlow.png
      - install -Dm644 icons/128x128.png /app/share/icons/hicolor/128x128/apps/com.paperflow.PaperFlow.png
      - install -Dm644 icons/256x256.png /app/share/icons/hicolor/256x256/apps/com.paperflow.PaperFlow.png
      - install -Dm644 icons/512x512.png /app/share/icons/hicolor/512x512/apps/com.paperflow.PaperFlow.png
    sources:
      - type: dir
        path: .
