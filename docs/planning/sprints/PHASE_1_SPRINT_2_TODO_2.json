{
  "phase": 1,
  "sprint": 2,
  "todoFile": 2,
  "title": "File Saving Operations",
  "priority": "HIGH",
  "effort": "17 hours",
  "status": "completed",
  "milestone": "Internal Alpha Complete",
  "tasks": [
    {
      "id": "2.2.1",
      "category": "file",
      "title": "Implement Save to Original File",
      "description": "Save changes back to original file using File System Access API.",
      "status": "completed",
      "estimatedHours": 5,
      "agent": "sonnet",
      "files": [
        "src/hooks/useFileSystem.ts",
        "src/lib/pdf/saver.ts"
      ],
      "testCategories": [
        "integration"
      ],
      "acceptanceCriteria": [
        "Save overwrites original file when handle exists",
        "Prompt for location if no handle",
        "Save confirmation toast shows",
        "Modified indicator clears after save"
      ]
    },
    {
      "id": "2.2.2",
      "category": "file",
      "title": "Implement Save As Functionality",
      "description": "Save document with new filename using file picker.",
      "status": "completed",
      "estimatedHours": 3,
      "agent": "haiku",
      "files": [
        "src/hooks/useFileSystem.ts"
      ],
      "testCategories": [
        "integration"
      ],
      "acceptanceCriteria": [
        "Save As opens file picker",
        "New filename can be specified",
        "File saves to selected location"
      ]
    },
    {
      "id": "2.2.3",
      "category": "file",
      "title": "Add Download Fallback",
      "description": "Provide download fallback for browsers without File System Access API.",
      "status": "completed",
      "estimatedHours": 2,
      "agent": "haiku",
      "files": [
        "src/lib/storage/fileHandler.ts"
      ],
      "testCategories": [
        "integration"
      ],
      "acceptanceCriteria": [
        "Download triggers for unsupported browsers",
        "Suggested filename used",
        "Blob URL generated correctly"
      ]
    },
    {
      "id": "2.2.4",
      "category": "file",
      "title": "Track Document Modified State",
      "description": "Track changes and warn before closing with unsaved changes.",
      "status": "completed",
      "estimatedHours": 3,
      "agent": "haiku",
      "files": [
        "src/stores/documentStore.ts",
        "src/hooks/useBeforeUnload.ts"
      ],
      "testCategories": [
        "unit",
        "integration"
      ],
      "acceptanceCriteria": [
        "Modified indicator (*) shows in header",
        "beforeunload warning shows",
        "Confirmation dialog on close with unsaved changes"
      ]
    },
    {
      "id": "2.2.5",
      "category": "file",
      "title": "Implement Auto-Save to IndexedDB",
      "description": "Auto-save document to IndexedDB every 30 seconds (configurable).",
      "status": "completed",
      "estimatedHours": 4,
      "agent": "sonnet",
      "files": [
        "src/lib/storage/indexeddb.ts",
        "src/hooks/useAutoSave.ts"
      ],
      "testCategories": [
        "unit",
        "integration"
      ],
      "acceptanceCriteria": [
        "Document saves every 30 seconds",
        "Interval configurable in settings",
        "Auto-save can be disabled",
        "Restore prompt on reopen"
      ]
    }
  ],
  "successCriteria": [
    "Save/Save As/Download all functional",
    "Modified indicator shows when document changed",
    "Unsaved changes warning on close",
    "Auto-save works reliably"
  ],
  "filesCreated": [
    "src/lib/pdf/saver.ts",
    "src/hooks/useAutoSave.ts",
    "src/hooks/useBeforeUnload.ts"
  ],
  "filesModified": [
    "src/hooks/useFileSystem.ts",
    "src/lib/storage/indexeddb.ts",
    "src/lib/storage/fileHandler.ts",
    "src/stores/documentStore.ts",
    "src/stores/settingsStore.ts"
  ],
  "totalNewTests": 8,
  "totalEstimatedHours": 17,
  "dependencies": [
    "PHASE_1_SPRINT_2_TODO_1"
  ],
  "notes": [
    "File System Access API requires user gesture to request file handle",
    "Auto-save should not block the UI"
  ]
}